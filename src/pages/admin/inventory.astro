---
import Layout from "../../layouts/Layout.astro";
import { getStock } from "../../utils/stock";

const stockData = Astro.locals.runtime ? await getStock(Astro.locals.runtime.env) : {};
---

<Layout title="Admin - Inventario">
    <section class="admin-section">
        <div class="container">
            <h1>Gesti√≥n de Inventario</h1>

            {
                Object.keys(stockData).length > 0 ? (
                    <div class="inventory-cards">
                        {Object.entries(stockData).map(([sku, stock]) => (
                            <div class="inventory-card">
                                <div class="card-header">
                                    <h2 class="sku-title">{sku}</h2>
                                </div>
                                <div class="card-content">
                                    <div class="stat-row">
                                        <span class="stat-label">
                                            Disponible
                                        </span>
                                        <span class="stat-value">
                                            {stock.disponible}
                                        </span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">
                                            Reservado
                                        </span>
                                        <span class="stat-value">
                                            {stock.reservado}
                                        </span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">Total</span>
                                        <span class="stat-value total">
                                            {stock.total}
                                        </span>
                                    </div>
                                    {stock.notas && (
                                        <div class="notes-container">
                                            <span class="notes-label">
                                                Notas:
                                            </span>
                                            <p class="notes-content">
                                                {stock.notas}
                                            </p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        ))}
                    </div>
                ) : (
                    <div class="no-data-message">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="48"
                            height="48"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        >
                            <path d="M21 8V21H3V8" />
                            <path d="M3 4h18l-9 4-9-4z" />
                        </svg>
                        <p>No hay datos de inventario disponibles</p>
                    </div>
                )
            }
        </div>
    </section>
</Layout>

<style>
    .admin-section {
        padding: 1rem;
        max-width: 1200px;
        margin: 0 auto;
    }

    h1 {
        margin-bottom: 1.5rem;
        color: #2d3748;
        font-size: 1.5rem;
        text-align: center;
    }

    .inventory-cards {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1rem;
    }

    .inventory-card {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        overflow: hidden;
        transition:
            transform 0.2s,
            box-shadow 0.2s;
    }

    .inventory-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    }

    .card-header {
        background-color: #f7fafc;
        padding: 1rem;
        border-bottom: 1px solid #e2e8f0;
    }

    .sku-title {
        margin: 0;
        font-size: 1.1rem;
        font-weight: 600;
        color: #2d3748;
    }

    .card-content {
        padding: 1rem;
    }

    .stat-row {
        display: flex;
        justify-content: space-between;
        padding: 0.5rem 0;
        border-bottom: 1px solid #f0f4f8;
    }

    .stat-row:last-of-type {
        margin-bottom: 0.5rem;
    }

    .stat-label {
        color: #718096;
        font-weight: 500;
    }

    .stat-value {
        font-weight: 600;
        color: #2d3748;
    }

    .stat-value.total {
        color: #3182ce;
    }

    .notes-container {
        margin-top: 0.75rem;
        padding-top: 0.75rem;
        border-top: 1px dashed #e2e8f0;
    }

    .notes-label {
        display: block;
        font-weight: 500;
        color: #718096;
        margin-bottom: 0.25rem;
    }

    .notes-content {
        margin: 0;
        color: #4a5568;
        font-size: 0.9rem;
        line-height: 1.4;
    }

    .no-data-message {
        text-align: center;
        padding: 3rem 1rem;
        background-color: #f9fafb;
        border-radius: 8px;
        color: #718096;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
    }

    .no-data-message svg {
        color: #a0aec0;
    }

    .no-data-message p {
        margin: 0;
        font-size: 1.1rem;
    }

    /* Tablet (md) */
    @media (min-width: 768px) {
        .admin-section {
            padding: 1.5rem;
        }

        h1 {
            font-size: 1.8rem;
            text-align: left;
        }

        .inventory-cards {
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }
    }

    /* Desktop (lg) */
    @media (min-width: 1024px) {
        .admin-section {
            padding: 2rem;
        }

        .inventory-cards {
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
        }

        .card-header {
            padding: 1.25rem;
        }

        .card-content {
            padding: 1.25rem;
        }
    }

    @media (min-width: 1280px) {
        .inventory-cards {
            grid-template-columns: repeat(4, 1fr);
        }
    }
</style>
